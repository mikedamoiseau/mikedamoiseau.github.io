
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->

<head>


<meta charset="utf-8">
<meta http-equiv="cleartype" content="on">

<title>Les Entrées Des Menus Wordpress Seraient-elles Limitées? - Damoiseau.ME, Le blog d&#8217;un développeur web</title>
<meta name="author" content="Michael Damoiseau">




<meta name="description" content="Des articles écrits au fur et à mesure de mes pérégrinations dans le monde du développement web">

<meta name="keywords" content="wordpress php damoiseau,damoiseau.me">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Twitter Cards -->

  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content"">
  
  <meta name="twitter:title" content="Les entrées des menus Wordpress seraient-elles limitées?">
  <meta name="twitter:description" content="Des articles écrits au fur et à mesure de mes pérégrinations dans le monde du développement web">
  <meta name="twitter:creator" content="@mike_dam">


<!-- Facebook -->
<meta property="fb:admins" content="550638906" />

<!-- Misc SEO stuff -->
<meta name="alexaVerifyID" content="9iD_etzJ6nDCsM7yizgVwQ_fSY8" />
<meta name="msvalidate.01" content="A39307D8057EC4F14EA412A8F540FB32" />
<meta name="google-site-verification" content="4JzD6y7FmLIR40JG0J-kxUBWx-gZ36_eP1QDqAwwlcQ" />

<!-- Open Graph -->
<meta property="og:locale" content="fr_FR">
<meta property="og:type" content="website">
<meta property="og:url" content="http://mikedamoiseau.github.io/les-entrees-des-menus-wordpress-seraient-elles-limitees">
<meta property="og:title" content="Les entrées des menus Wordpress seraient-elles limitées?">
<meta property="og:description" content="Des articles écrits au fur et à mesure de mes pérégrinations dans le monde du développement web">

  <meta property="og:image" content="http://mikedamoiseau.github.io">

<meta property="og:site_name" content="Damoiseau.ME, Le blog d'un développeur web">

<link rel="canonical" href="http://mikedamoiseau.github.io/les-entrees-des-menus-wordpress-seraient-elles-limitees">
<link href="/favicon.png" rel="icon">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
<link href="/atom.xml" rel="alternate" title="Damoiseau.ME, Le blog d'un développeur web" type="application/atom+xml">

<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
<script>Modernizr || document.write('<script src="/javascripts/vendor/modernizr-2.6.2.custom.min.js"><\/script>') </script>



<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Ouvrir le menu</button>
	<ul class="dl-menu">
		<li><a href="/">Accueil</a></li>
		<li>
			<a href="#">A propos</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/damoiseau-1.jpg" alt="Michael Damoiseau photo" class="author-photo">
					<h4>Michael Damoiseau</h4>
					<p>Développeur web vivant à Chiang Mai, dans le nord de la Thaïlande</p>
				</li>
				
				
				<li>
					<a href="http://twitter.com/mike_dam"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="http://plus.google.com/+MichaëlDamoiseau"><i class="fa fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="http://github.com/mikedamoiseau"><i class="fa fa-github"></i> GitHub</a>
				</li>
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Articles</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">Tous les articles</a></li>
				<li><a href="/categories/">Toutes les catégories</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="/les-entrees-des-menus-wordpress-seraient-elles-limitees" rel="bookmark" title="Les entrées des menus Wordpress seraient-elles limitées?">Les entrées des menus Wordpress seraient-elles limitées?</a></h1>
        
        <h2>01/10/2013</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <h5>Le client</h5>

<p>Aujourd&#8217;hui je me suis retrouvé face à un problème extrêmement intéressant! Un client m&#8217;a contacté car il rencontrait un problème étrange&hellip; &ldquo;La sauvegarde des menus ne fonctionnent plus dans l&#8217;administration !&rdquo; me dit-il sur un ton qui sous-entend que j&#8217;ai encore fait quelque chose que je n&#8217;aurais pas dû (non non, promis, c&#8217;est pas moi!).</p>

<h5>Constatation du problème</h5>

<p>Après investigation, j&#8217;ai constaté que la sauvegarde fonctionnait pour les entrées existantes du menu, mais que Wordpress refusait obstinément de sauvegarder les nouvelles entrées. Cela ressemble étrangement à une limite de Wordpress, genre &ldquo;Wordpress a décidé que vous ne pouvez pas avoir plus de 70 entrées dans un menu&rdquo;.</p>

<!--more-->


<h5>Un peu de théorie</h5>

<p>Et bien en fait, non, rien à voir&hellip; Le problème ne vient pas de Wordpress, mais plutôt de la configuration de votre PHP! Mais commençons par le début&hellip;</p>

<p>Une entrée d&#8217;un menu possède un certain nombre de propriétés, parmis lesquelles son nom, son attribut html <code>title</code>, l&#8217;option <code>target</code>, la ou les classes css, et encore deux ou trois autres trucs. Au minimum, une entrée d&#8217;un menu aura 6 propriétés, sans compter les ID&rsquo;s et autres propriétés propres à l&#8217;utilisation de Wordpress! Vous l&#8217;avez maintenant compris, pour un gros menu, on arrive facilement à un nombre conséquent de propriétés.</p>

<h5>La responsable</h5>

<p>Lorsque vous sauvegardez un menu dans l&#8217;administration de Wordpress, toutes ces propriétés vont être placées dans des tableaux PHP (<code>array</code>) pour ensuite être envoyées au serveur via une requête POST. Hors, il se trouve que depuis <a href="http://php.net/releases/5_3_9.php" title="PHP 5.3.9">PHP 5.3.9</a>, une nouvelle option a fait son apparition. Elle s&#8217;appelle <code>max_input_vars</code> et est probablement la responsable de la disparition de vos entrées!</p>

<p><code>max_input_vars</code> est une option qui permet de limiter le nombre de tableaux envoyés dans une requête POST. Cette option est souvent limitée à 1000, ce aui semble suffisant pour une utilisation courante de PHP. Dans le cas de Wordpress, si votre menu possède au minimum 60-70 entrées, cette limite sera rapidement atteinte, et PHP ignorera tout ce qui se trouve après.
PHP émet bien un Warning si la limite est atteinte, mais la plupart des sites en production n&#8217;affichent pas les warning et les stockent dans des fichiers logs. Et un utilisateur Wordpress, quand il sait ce qu&#8217;est un fichier log (ce qui n&#8217;est pas gagné&hellip;), ne pensera pas forcément à aller analyser le contenu de ses logs!</p>

<h5>La solution</h5>

<p>Nous savons donc maintenant comment fonctionne la sauvegarde des menus (plein de tableaux contenant les propriétés des menus et de leurs entrées dans une requête POST). Nous savons également que PHP, depuis sa version 5.3.9, possède une option qui limite le nombre de tableaux dans une requête POST. Bien! Maintenant il ne nous reste plus qu&#8217;à régler le problème&hellip;</p>

<p>Et régler le problème est extrêmement simple&hellip; ou pas:</p>

<ul>
<li><strong>Vous avez accès au fichier <code>php.ini</code></strong>
Dans ce cas, super simple! Il vous suffit d&#8217;ajouter cette ligne dans votre fichier <code>php.ini</code> (ou de modifier la ligne existante si elle s&#8217;y trouve déjà ):</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>max_input_vars = 3000</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p><strong>Vous n&#8217;avez pas accès au fichier <code>php.ini</code></strong>
Pas de panique, vous avez deux solutions:</p>

<ul>
<li>  Vous avez accès au fichier <code>.htaccess</code>
Ajouter la ligne suivante dans votre fichier <code>.htaccess</code>:</li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>php_value max_input_vars 3000</span></code></pre></td></tr></table></div></figure>


<p><strong>Attention: il semblerait que la modification du fichier <code>.htaccess</code> soit délicate&hellip; Je me suis retrouvé avec un site complet en erreur 500!</strong> J&#8217;ai donc préféré la méthode suivante:</p>

<ul>
<li>Créez un fichier php.ini dans le répertoire <code>wp-admin</code> et ajoutez-y la ligne suivante:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>max_input_vars = 3000</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Ca ne marche toujours pas</li>
</ul>


<p>Avant l&#8217;utilisation de l&#8217;option <code>max_input_vars</code>, de nombreux hébergeurs utilisaient un module de sécurité appelé <code>Suhosin PHP Security</code>.
Tout ce qui a été dit précédemment reste d&#8217;actualité, mais le contenu des fichiers <code>php.ini</code> et/ou <code>.htaccess</code> sont différents:</p>

<ul>
<li><strong><code>php.ini</code></strong></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'><span class="c1"># nouvelle option à partir de php 5.3.9</span>
</span><span class='line'><span class="na">max_input_vars</span> <span class="o">=</span> <span class="s">3000</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># module Suhosin PHP Security</span>
</span><span class='line'><span class="na">suhosin.post.max_vars</span> <span class="o">=</span> <span class="s">3000</span>
</span><span class='line'><span class="na">suhosin.request.max_vars</span> <span class="o">=</span> <span class="s">3000</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><strong><code>.htaccess</code></strong></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># nouvelle option à partir de php 5.3.9
</span><span class='line'>php_value max_input_vars 3000
</span><span class='line'>
</span><span class='line'>    # module Suhosin PHP Security
</span><span class='line'>php_value suhosin.post.max_vars 3000
</span><span class='line'>php_value suhosin.request.max_vars 3000</span></code></pre></td></tr></table></div></figure>


      <footer class="entry-meta">
        <span class="entry-tags"><a href="/categories/#wordpress" title="Pages tagged wordpress" class="tag">wordpress</a><a href="/categories/#php" title="Pages tagged php" class="tag">php</a></span>
        <span><a href="/les-entrees-des-menus-wordpress-seraient-elles-limitees" rel="bookmark" title="Les entrées des menus Wordpress seraient-elles limitées?">Les entrées des menus Wordpress seraient-elles limitées?</a> was published on <span class="entry-date date published updated"><time datetime="2013-10-01T12:40:30+07:00">October 01, 2013</time></span></span>
        
        <span class="author vcard"><span class="fn"><a href="" title="About Michael Damoiseau">Michael Damoiseau</a></span></span>
        
      </footer>
    </div><!-- /.entry-content -->
    
      <div class="read-more">
        
          <div class="read-more-header">
            <a href="/wordpress-4.1-disponible-au-telechargement" class="btn">Continuer la lecture</a>
          </div><!-- /.read-more-header -->
          <div class="read-more-content">
            <h3><a href="/wordpress-4.1-disponible-au-telechargement" title="Wordpress 4.1 disponible au téléchargement">Wordpress 4.1 disponible au téléchargement</a></h3>
            <p>Quoi de neuf dans cette nouvelle mouture de Wordpress? Et bien pas mal de nouveautés en fait! Certaines d&#8217;entre elles étant très &hellip;&hellip; <a href="/wordpress-4.1-disponible-au-telechargement"> Continuer la lecture</a></p>
          </div><!-- /.read-more-content -->
        
        <div class="read-more-list">
          
            <div class="list-item">
              <h4><a href="/tester-le-rendu-de-votre-site-internet-simultanement-sur-plusieurs-peripheriques-avec-browsersync" title="Tester le rendu de votre site internet simultanément sur plusieurs périphériques avec BrowserSync">Tester le rendu de votre site internet simultanément sur plusieurs périphériques avec BrowserSync</a></h4>
              <span>Publié le 30/10/2014</span>
            </div><!-- /.list-item -->
          
            <div class="list-item">
              <h4><a href="/wordpress-filtres-actions-partie-2" title="Wordpress, des filtres et des actions (2ème partie)">Wordpress, des filtres et des actions (2ème partie)</a></h4>
              <span>Publié le 19/10/2014</span>
            </div><!-- /.list-item -->
          
        </div><!-- /.read-more-list -->
      </div><!-- /.read-more -->
    
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Michael Damoiseau. Powered by <a href="http://octopress.org">Octopress</a> using the <a href="https://github.com/Z1MM32M4N/hpstr-theme/">HPSTR Theme for Octopress</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->



<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/javascripts/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/javascripts/octopress.js" type="text/javascript"></script>
<script src="/javascripts/scripts.min.js"></script>

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-43047575-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>




<script type="text/javascript">
      var disqus_shortname = 'damoiseaume';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mikedamoiseau.github.io/les-entrees-des-menus-wordpress-seraient-elles-limitees';
        var disqus_url = 'http://mikedamoiseau.github.io/les-entrees-des-menus-wordpress-seraient-elles-limitees';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




</body>
</html>
